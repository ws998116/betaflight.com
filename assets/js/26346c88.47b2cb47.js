"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5254],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>f});var o=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var u=o.createContext({}),l=function(e){var t=o.useContext(u),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=l(e.components);return o.createElement(u.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,u=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=l(r),m=n,f=d["".concat(u,".").concat(m)]||d[m]||p[m]||a;return r?o.createElement(f,i(i({ref:t},c),{},{components:r})):o.createElement(f,i({ref:t},c))}));function f(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,i=new Array(a);i[0]=m;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s[d]="string"==typeof e?e:n,i[1]=s;for(var l=2;l<a;l++)i[l]=r[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,r)}m.displayName="MDXCreateElement"},94916:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var o=r(87462),n=(r(67294),r(3905));const a={},i=void 0,s={unversionedId:"documentation/Custom Board Configuration",id:"documentation/Custom Board Configuration",title:"Custom Board Configuration",description:"Custom Board Configuration Using CLI",source:"@site/docs/documentation/Custom Board Configuration.md",sourceDirName:"documentation",slug:"/documentation/Custom Board Configuration",permalink:"/docs/documentation/Custom Board Configuration",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Controls",permalink:"/docs/documentation/Controls"},next:{title:"Create a Customized Version",permalink:"/docs/documentation/Customized Version"}},u={},l=[{value:"Custom Board Configuration Using CLI",id:"custom-board-configuration-using-cli",level:2}],c={toc:l};function d(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,o.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"custom-board-configuration-using-cli"},"Custom Board Configuration Using CLI"),(0,n.kt)("p",null,"Warning: This section covers beyond the normal use-case for Betaflight. It's recommended that you use a pre-made target configuration for a flight controller that has been thoroughly tested before. Those configurations can be found in the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/betaflight/unified-targets/tree/master/configs/default"},"unified targets list"),"."),(0,n.kt)("p",null,"However, Betaflight can provide support for custom-made flight controllers, assuming it contains supported hardware. Before using Betaflight at all, it's highly recommended that you, first, check to make sure your MCU and your peripherals are supported. Checking the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/betaflight/betaflight/wiki/Supported-Sensors"},"Supported Sensors")," and ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/betaflight/betaflight/wiki/Hardware-Reference"},"Hardware Reference")," wiki pages are good places to look. Betaflight is supported across many STM32 processors. Second, thoroughly test the functionality of your hardware by programming your board in an IDE (i.e. STMCube) or using any other hardware debugging methods/tools. "),(0,n.kt)("p",null,"Assuming your hardware is supported and you've thoroughly tested your peripherals, flash generic firmware into your board. It's recommended to flash betaflight firmware using the configurator and ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/betaflight/betaflight/blob/master/docs/USB%20Flashing.md"},"USB Flashing"),". "),(0,n.kt)("p",null,"To create your own configuration, you must first use the ",(0,n.kt)("inlineCode",{parentName:"p"},"resource")," command in the command line interface to map your peripheral pins on your controller. Use the CLI documentation linked above and other wiki pages for command reference. Then, you use the ",(0,n.kt)("inlineCode",{parentName:"p"},"set")," command to set the bus type, i2c address, lowpass filter frequency/type, baro_hardware, gyro_hardware, etc. This will mainly be dependent on your hardware and will involve a lot of trial and error. Use the ",(0,n.kt)("inlineCode",{parentName:"p"},"save")," command to save your configuration and reboot the controller. If your hardware is not detected, then you need to modify or create more settings in the CLI to accurately describe your hardware to Betaflight to detect it. Use your custom board's and respective peripherals' datasheets and schematics to help you."),(0,n.kt)("p",null,"Alongside ",(0,n.kt)("inlineCode",{parentName:"p"},"resource")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"set")," commands, there are ",(0,n.kt)("inlineCode",{parentName:"p"},"timer")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"dma")," commands. For certain functions, such as battery voltage monitoring and motor output, you need to associate a timer and/or a Direct Memory Access (DMA) channel to those pins for those to work."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"# timer")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"timer <pin> AF(x) [1-3]")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"# dma")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"dma [SPI_TX|ADC|pin] [index|pin] [0|1]"))),(0,n.kt)("p",null,"For custom configuration like this outside the normal use-case, it's recommended that you use the pre-made ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/betaflight/unified-targets/tree/master/configs/default"},"configs")," as a source of reference."))}d.isMDXComponent=!0}}]);